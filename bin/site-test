#!/bin/bash
#
# Run a project's tests.

set -e

if [ -f composer.json ] && jq -e '.scripts["test"]' composer.json >/dev/null 2>&1; then
	echo -e "\033[97;44mphpUnit\033[0m"
	composer test
elif [ -f phpunit.xml ] && [ -f vendor/bin/phpunit ]; then
	echo -e "\033[97;44mphpUnit\033[0m"
	vendor/bin/phpunit
fi

#if [ -d vendor/laravel/dusk ]; then
#	echo -e "\033[97;44mLaravel Dusk\033[0m"
#	laravel-dusk
#fi

if [ -f composer.json ] && jq -e '.scripts["lint"]' composer.json; then
	echo -e "\033[97;44mChecktyle PHP\033[0m"
	composer lint
fi

if [ -f package.json ] && cat package.json | jq -e '.scripts | has("lint")' > /dev/null; then
	echo -e "\033[97;44mChecktyle JavaScript\033[0m"
	yarn lint
fi
